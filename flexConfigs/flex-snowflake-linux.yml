---
integrations:
  - name: nri-flex
    interval: 600s
    config:
      name: snowflake
      custom_attributes:
        environment: production
        snowflake_account: $$SNOWSQL_ACCOUNT
      global:
        timeout: 300000
      apis:
        # Query History emits under a different event type - SnowflakeVirtualWarehouse
        # since these metrics are related to a particular warehouse.
        - name: snowflakeQueryHistory
          entity: snowflake
          event_type: SnowflakeVirtualWarehouse
          custom_attributes:
            metric_type: snowflake.query_performance
          commands:
            - run: /home/nri-agent/newrelic-snowflake-integration/snowflakeintegration-linux /home/nri-agent/newrelic-snowflake-integration/config.yaml /home/nri-agent/newrelic-snowflake-integration/queries/query_history.sql
        - name: longestQueries
          entity: snowflake
          event_type: SnowflakeVirtualWarehouse
          custom_attributes:
            metric_type: snowflake.change_back_later
          commands: 
            - run: /home/nri-agent/newrelic-snowflake-integration/snowflakeintegration-linux /home/nri-agent/newrelic-snowflake-integration/config.yaml /home/nri-agent/newrelic-snowflake-integration/queries/longest_queries.sql
              